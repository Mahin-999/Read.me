<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBA Section 3B Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out forwards; opacity: 0; transform: translateY(10px); }
        .delay-100 { animation-delay: 0.1s; }
        .delay-200 { animation-delay: 0.2s; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONS (Inline SVGs for portability) ---
        const IconClock = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>;
        const IconMapPin = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>;
        const IconUser = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>;
        const IconSparkles = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path></svg>;
        const IconMoon = ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg>;

        // --- DATA ---
        const SCHEDULE = [
            // Sunday (Day 0)
            { day: 0, dayName: 'Sunday', startTime: '11:00', endTime: '12:30', code: 'MKT 2127', title: 'Principles of Marketing', room: '006 (MB)', faculty: 'SKG 2' },
            { day: 0, dayName: 'Sunday', startTime: '13:00', endTime: '14:30', code: 'GED 1117', title: 'History of Bangladesh', room: '217 (MB)', faculty: 'GED 2 DMA' },
            { day: 0, dayName: 'Sunday', startTime: '16:00', endTime: '17:30', code: 'BIS 2122', title: 'Computer Applications', room: '501 (MB)', faculty: 'MZT 1' },
            // Monday (Day 1)
            { day: 1, dayName: 'Monday', startTime: '11:00', endTime: '12:30', code: 'MAT 1110', title: 'Basic Math', room: '501 (MB)', faculty: 'MSB 2' },
            // Tuesday (Day 2)
            { day: 2, dayName: 'Tuesday', startTime: '11:00', endTime: '12:30', code: 'MKT 2127', title: 'Principles of Marketing', room: '006 (MB)', faculty: 'SKG 2' },
            { day: 2, dayName: 'Tuesday', startTime: '13:00', endTime: '14:30', code: 'GED 1117', title: 'History of Bangladesh', room: '217 (MB)', faculty: 'GED 2 DMA' },
            { day: 2, dayName: 'Tuesday', startTime: '16:00', endTime: '17:30', code: 'BIS 2122', title: 'Computer Applications', room: '501 (MB)', faculty: 'MZT 1' },
            // Wednesday (Day 3)
            { day: 3, dayName: 'Wednesday', startTime: '11:00', endTime: '12:30', code: 'MAT 1110', title: 'Basic Math', room: '501 (MB)', faculty: 'MSB 2' },
        ];

        // --- MAIN APP COMPONENT ---
        function App() {
            const [currentTime, setCurrentTime] = useState(new Date());
            const [currentStatus, setCurrentStatus] = useState(null);
            const [nextClass, setNextClass] = useState(null);
            const [loadingAI, setLoadingAI] = useState(false);
            const [aiResponse, setAiResponse] = useState(null);
            const [activeTab, setActiveTab] = useState('dashboard');
            
            const apiKey = ""; // API Key

            useEffect(() => {
                const timer = setInterval(() => setCurrentTime(new Date()), 1000 * 60);
                calculateStatus();
                return () => clearInterval(timer);
            }, [currentTime]);

            const calculateStatus = () => {
                const now = new Date();
                const currentDay = now.getDay();
                const currentHour = now.getHours();
                const currentMinute = now.getMinutes();
                const currentTimeValue = currentHour * 60 + currentMinute;

                // 1. Check Active
                const activeClass = SCHEDULE.find(cls => {
                    if (cls.day !== currentDay) return false;
                    const [startH, startM] = cls.startTime.split(':').map(Number);
                    const [endH, endM] = cls.endTime.split(':').map(Number);
                    return currentTimeValue >= (startH * 60 + startM) && currentTimeValue < (endH * 60 + endM);
                });

                if (activeClass) {
                    setCurrentStatus({ type: 'active', class: activeClass });
                    setNextClass(findNextClass(currentDay, currentTimeValue));
                    return;
                }

                // 2. Check Upcoming Today
                const upcomingToday = SCHEDULE.filter(cls => {
                    if (cls.day !== currentDay) return false;
                    const [startH, startM] = cls.startTime.split(':').map(Number);
                    return (startH * 60 + startM) > currentTimeValue;
                }).sort((a, b) => {
                    const [aH, aM] = a.startTime.split(':').map(Number);
                    const [bH, bM] = b.startTime.split(':').map(Number);
                    return (aH * 60 + aM) - (bH * 60 + bM);
                });

                if (upcomingToday.length > 0) {
                    const next = upcomingToday[0];
                    const [startH, startM] = next.startTime.split(':').map(Number);
                    const diff = (startH * 60 + startM) - currentTimeValue;
                    setCurrentStatus({ type: 'upcoming', diff: diff, class: next });
                    setNextClass(upcomingToday.length > 1 ? upcomingToday[1] : findNextClass(currentDay + 1, 0));
                    return;
                }

                // 3. Free
                setCurrentStatus({ type: 'free' });
                setNextClass(findNextClass(currentDay + 1, 0));
            };

            const findNextClass = (startDay, timeVal) => {
                for (let i = 0; i < 7; i++) {
                    const checkDay = (startDay + i) % 7;
                    const daysClasses = SCHEDULE.filter(c => c.day === checkDay);
                    if (i === 0) {
                        const upcoming = daysClasses.filter(c => {
                             const [h, m] = c.startTime.split(':').map(Number);
                             return (h * 60 + m) > timeVal;
                        });
                        if (upcoming.length > 0) return upcoming[0];
                    } else {
                        if (daysClasses.length > 0) return daysClasses[0];
                    }
                }
                return null;
            };

            const getAiStudyTips = async (courseTitle) => {
                setLoadingAI(true);
                setAiResponse(null);
                try {
                    const prompt = `Give me 3 short, actionable study tips specifically for an undergraduate student taking "${courseTitle}". Be encouraging.`;
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });
                    const data = await response.json();
                    const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Couldn't fetch tips.";
                    setAiResponse({ course: courseTitle, text: text });
                } catch (error) {
                    setAiResponse({ course: courseTitle, text: "Error connecting to AI advisor." });
                } finally {
                    setLoadingAI(false);
                }
            };

            return (
                <div className="min-h-screen bg-slate-50 text-slate-800 font-sans pb-20">
                    {/* Header */}
                    <header className="bg-gradient-to-r from-violet-600 to-sky-500 text-white p-6 rounded-b-3xl shadow-lg mb-6">
                        <div className="flex justify-between items-start mb-4">
                            <div>
                                <h1 className="text-2xl font-bold">Spring 2026</h1>
                                <p className="opacity-80 text-sm">BBA Section 3B</p>
                            </div>
                            <div className="text-right">
                                <div className="text-3xl font-mono font-bold tracking-tight">
                                    {currentTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                </div>
                                <div className="text-sm opacity-80 uppercase tracking-wide">
                                    {currentTime.toLocaleDateString([], { weekday: 'short', month: 'short', day: 'numeric' })}
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="px-4 max-w-md mx-auto space-y-6">
                        {/* Tabs */}
                        <div className="flex bg-white p-1 rounded-xl shadow-sm border border-slate-100">
                            <button onClick={() => setActiveTab('dashboard')} className={`flex-1 py-2 text-sm font-semibold rounded-lg transition-all ${activeTab === 'dashboard' ? 'bg-slate-800 text-white shadow-md' : 'text-slate-500 hover:bg-slate-50'}`}>Live Dash</button>
                            <button onClick={() => setActiveTab('schedule')} className={`flex-1 py-2 text-sm font-semibold rounded-lg transition-all ${activeTab === 'schedule' ? 'bg-slate-800 text-white shadow-md' : 'text-slate-500 hover:bg-slate-50'}`}>Full Week</button>
                        </div>

                        {activeTab === 'dashboard' && (
                            <>
                                {/* Status Card */}
                                <div className="animate-fade-in-up">
                                    <h2 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 ml-1">Current Status</h2>
                                    {currentStatus?.type === 'active' ? (
                                        <div className="bg-white border-l-4 border-emerald-500 rounded-xl shadow-md p-5 relative overflow-hidden">
                                            <div className="absolute top-0 right-0 bg-emerald-500 text-white text-xs font-bold px-2 py-1 rounded-bl-lg">NOW</div>
                                            <div className="flex items-center gap-2 text-emerald-600 font-bold mb-1">
                                                <span className="relative flex h-3 w-3"><span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span><span className="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span></span>
                                                CLASS IN SESSION
                                            </div>
                                            <h3 className="text-2xl font-bold text-slate-800 leading-tight">{currentStatus.class.title}</h3>
                                            <div className="flex gap-4 mt-3 text-sm text-slate-600">
                                                <div className="flex items-center gap-1"><IconMapPin className="w-4 h-4" /> {currentStatus.class.room}</div>
                                                <div className="flex items-center gap-1"><IconUser className="w-4 h-4" /> {currentStatus.class.faculty}</div>
                                            </div>
                                            <div className="mt-3 text-xs bg-emerald-50 text-emerald-700 py-1 px-2 rounded inline-block">Ends at {currentStatus.class.endTime}</div>
                                        </div>
                                    ) : currentStatus?.type === 'upcoming' ? (
                                        <div className="bg-white border-l-4 border-amber-500 rounded-xl shadow-md p-5">
                                            <div className="flex items-center gap-2 text-amber-600 font-bold mb-1">
                                                <IconClock className="w-4 h-4" />
                                                STARTS IN {Math.floor(currentStatus.diff / 60) > 0 ? `${Math.floor(currentStatus.diff / 60)}h ` : ''}{currentStatus.diff % 60} MIN
                                            </div>
                                            <h3 className="text-xl font-bold text-slate-800">{currentStatus.class.title}</h3>
                                            <div className="text-slate-500 text-sm mb-3">{currentStatus.class.code}</div>
                                            <div className="flex justify-between items-end">
                                                <div className="space-y-1 text-sm text-slate-600">
                                                    <div className="flex items-center gap-1"><IconMapPin className="w-4 h-4 text-amber-500"/> {currentStatus.class.room}</div>
                                                    <div className="flex items-center gap-1"><IconUser className="w-4 h-4 text-amber-500"/> {currentStatus.class.faculty}</div>
                                                </div>
                                                <div className="text-2xl font-bold text-slate-800">{currentStatus.class.startTime}</div>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="bg-gradient-to-br from-indigo-500 to-purple-600 text-white rounded-xl shadow-md p-6 text-center">
                                            <IconMoon className="w-10 h-10 mx-auto mb-3 opacity-80" />
                                            <h3 className="text-xl font-bold mb-1">You are free!</h3>
                                            <p className="opacity-80 text-sm">No classes currently in session.</p>
                                        </div>
                                    )}
                                </div>

                                {/* Up Next */}
                                {nextClass && (
                                    <div className="animate-fade-in-up delay-100">
                                        <h2 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 ml-1 mt-6">Up Next</h2>
                                        <div className="bg-white rounded-xl shadow-sm border border-slate-100 p-4 opacity-80 hover:opacity-100 transition-opacity">
                                            <div className="flex justify-between items-center mb-2">
                                                <span className="text-xs font-bold bg-slate-100 text-slate-500 px-2 py-1 rounded uppercase">{nextClass.dayName}</span>
                                                <span className="font-mono font-bold text-slate-700">{nextClass.startTime}</span>
                                            </div>
                                            <h3 className="font-bold text-slate-800">{nextClass.title}</h3>
                                            <div className="flex items-center gap-1 text-sm text-slate-500 mt-1">
                                                <IconMapPin className="w-3 h-3" /> {nextClass.room}
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* AI Advisor */}
                                <div className="mt-8 animate-fade-in-up delay-200">
                                    <div className="bg-gradient-to-br from-violet-600 to-indigo-700 rounded-2xl p-5 text-white shadow-xl relative overflow-hidden">
                                        <div className="absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-16 -mt-16 pointer-events-none"></div>
                                        <div className="relative z-10">
                                            <div className="flex items-center gap-2 mb-3">
                                                <IconSparkles className="w-5 h-5 text-amber-300" />
                                                <h2 className="font-bold">Gemini Study Advisor</h2>
                                            </div>
                                            {!aiResponse ? (
                                                <>
                                                    <p className="text-sm text-indigo-100 mb-4">Select a subject to get instant study tips tailored for this week.</p>
                                                    <div className="grid grid-cols-2 gap-2">
                                                        {['Marketing', 'History', 'Comp Apps', 'Basic Math'].map((sub) => (
                                                            <button key={sub} disabled={loadingAI} onClick={() => getAiStudyTips(sub)} className="bg-white/10 hover:bg-white/20 active:scale-95 transition-all text-xs font-semibold py-2 px-3 rounded text-center border border-white/10">{sub}</button>
                                                        ))}
                                                    </div>
                                                </>
                                            ) : (
                                                <div className="bg-white/10 rounded-lg p-3 border border-white/10">
                                                    <div className="flex justify-between items-start mb-2">
                                                        <span className="text-xs font-bold text-amber-300 uppercase">{aiResponse.course} Tips</span>
                                                        <button onClick={() => setAiResponse(null)} className="text-xs text-white/60 hover:text-white">Close</button>
                                                    </div>
                                                    <div className="text-sm text-indigo-50 leading-relaxed whitespace-pre-wrap">{aiResponse.text}</div>
                                                </div>
                                            )}
                                            {loadingAI && <div className="absolute inset-0 bg-indigo-900/80 backdrop-blur-sm flex items-center justify-center rounded-2xl"><div className="animate-pulse text-sm font-bold text-amber-300">Generating tips...</div></div>}
                                        </div>
                                    </div>
                                </div>
                            </>
                        )}

                        {activeTab === 'schedule' && (
                            <div className="space-y-6 animate-fade-in-up">
                                {[0, 1, 2, 3].map(dayIdx => {
                                    const dayName = ['Sunday', 'Monday', 'Tuesday', 'Wednesday'][dayIdx];
                                    const classes = SCHEDULE.filter(c => c.day === dayIdx);
                                    if (classes.length === 0) return null;
                                    return (
                                        <div key={dayIdx}>
                                            <h3 className="font-bold text-slate-400 text-sm uppercase tracking-wider mb-3 sticky top-0 bg-slate-50 py-2 z-10">{dayName}</h3>
                                            <div className="space-y-3">
                                                {classes.map((cls, idx) => (
                                                    <div key={idx} className="bg-white p-4 rounded-xl shadow-sm border-l-4 border-slate-200 hover:border-violet-500 transition-colors">
                                                        <div className="flex justify-between items-start mb-1">
                                                            <h4 className="font-bold text-slate-800">{cls.title}</h4>
                                                            <span className="text-xs bg-slate-100 px-2 py-1 rounded text-slate-600 font-mono">{cls.code}</span>
                                                        </div>
                                                        <div className="flex justify-between items-end mt-2">
                                                            <div className="text-sm text-slate-500 space-y-1">
                                                                <div className="flex items-center gap-2"><IconClock className="w-3 h-3"/> {cls.startTime} - {cls.endTime}</div>
                                                                <div className="flex items-center gap-2"><IconMapPin className="w-3 h-3"/> {cls.room}</div>
                                                                <div className="flex items-center gap-2"><IconUser className="w-3 h-3"/> {cls.faculty}</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )
                                })}
                                <div className="text-center text-slate-400 text-sm py-8 italic">Thursday, Friday & Saturday are off! ðŸŽ‰</div>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>